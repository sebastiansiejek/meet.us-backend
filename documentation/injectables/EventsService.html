<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>meet documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">meet documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li>Injectables</li>
  <li >EventsService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/events/events.service.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#create" >create</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#find" >find</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#findAll" >findAll</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#findAllForCalendar" >findAllForCalendar</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#findForEdit" >findForEdit</a>
                            </li>
                            <li>
                                <a href="#findOne" >findOne</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#remove" >remove</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#saveAddress" >saveAddress</a>
                            </li>
                            <li>
                                <a href="#saveVisit" >saveVisit</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#update" >update</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#updateAddress" >updateAddress</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#updateRate" >updateRate</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(eventsRepository: <a href="../classes/Event.html" target="_self">Repository&lt;Event&gt;</a>, eventAddressRepository: Repository<EventAddress>, userActivityService: <a href="../injectables/UserActivityService.html" target="_self">UserActivityService</a>, userService: <a href="../injectables/UsersService.html" target="_self">UsersService</a>, i18n: I18nService, notificationsService: <a href="../injectables/NotificationsService.html" target="_self">NotificationsService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="25" class="link-to-prism">src/events/events.service.ts:25</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>eventsRepository</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/Event.html" target="_self" >Repository&lt;Event&gt;</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>eventAddressRepository</td>
                                                  
                                                        <td>
                                                                    <code>Repository&lt;EventAddress&gt;</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>userActivityService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/UserActivityService.html" target="_self" >UserActivityService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>userService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/UsersService.html" target="_self" >UsersService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>i18n</td>
                                                  
                                                        <td>
                                                                    <code>I18nService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>notificationsService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/NotificationsService.html" target="_self" >NotificationsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="create"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>create</b></span>
                        <a href="#create"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>create(createEventInput: <a href="../classes/CreateEventInput.html" target="_self">CreateEventInput</a>, user: <a href="../classes/User.html" target="_self">User</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="38"
                            class="link-to-prism">src/events/events.service.ts:38</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>createEventInput</td>
                                    <td>
                                                <code><a href="../classes/CreateEventInput.html" target="_self" >CreateEventInput</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>user</td>
                                    <td>
                                                <code><a href="../classes/User.html" target="_self" >User</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="find"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>find</b></span>
                        <a href="#find"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>find(eventId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, userId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="68"
                            class="link-to-prism">src/events/events.service.ts:68</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>eventId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>userId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findAll"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>findAll</b></span>
                        <a href="#findAll"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findAll(limit: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, offset: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, field: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, sort: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, query: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, state: <a href="../classes/Event.html" target="_self">IEventState</a>, userId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, distance: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, latitude: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, longitude: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, loggedUser: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, type: <a href="../undefineds/eventType.html" target="_self">eventType</a>, clientDate?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="143"
                            class="link-to-prism">src/events/events.service.ts:143</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>limit</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>offset</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>field</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>sort</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>query</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>state</td>
                                    <td>
                                                <code><a href="../classes/Event.html" target="_self" >IEventState</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>userId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>distance</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>latitude</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>longitude</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>loggedUser</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>type</td>
                                    <td>
                                                <code><a href="../miscellaneous/enumerations.html#eventType" target="_self" >eventType</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>clientDate</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findAllForCalendar"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>findAllForCalendar</b></span>
                        <a href="#findAllForCalendar"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findAllForCalendar(limit: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, offset: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, field: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, sort: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, query: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, userId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, type: <a href="../undefineds/eventType.html" target="_self">eventType</a>, startDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>, endDate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="384"
                            class="link-to-prism">src/events/events.service.ts:384</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>limit</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>offset</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>field</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>sort</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>query</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>userId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>type</td>
                                    <td>
                                                <code><a href="../miscellaneous/enumerations.html#eventType" target="_self" >eventType</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>startDate</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>endDate</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findForEdit"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>findForEdit</b></span>
                        <a href="#findForEdit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>findForEdit(eventId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, userId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="54"
                            class="link-to-prism">src/events/events.service.ts:54</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>eventId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>userId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="findOne"></a>
                    <span class="name">
                        <span ><b>findOne</b></span>
                        <a href="#findOne"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>findOne(eventId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="136"
                            class="link-to-prism">src/events/events.service.ts:136</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>eventId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="remove"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>remove</b></span>
                        <a href="#remove"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>remove(eventId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="336"
                            class="link-to-prism">src/events/events.service.ts:336</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>eventId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="saveAddress"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>saveAddress</b></span>
                        <a href="#saveAddress"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>saveAddress(event: <a href="../classes/Event.html" target="_self">Event</a>, eventAddress: <a href="../classes/CreateEventAddressInput.html" target="_self">CreateEventAddressInput</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="347"
                            class="link-to-prism">src/events/events.service.ts:347</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>event</td>
                                    <td>
                                                <code><a href="../classes/Event.html" target="_self" >Event</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>eventAddress</td>
                                    <td>
                                                <code><a href="../classes/CreateEventAddressInput.html" target="_self" >CreateEventAddressInput</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="saveVisit"></a>
                    <span class="name">
                        <span ><b>saveVisit</b></span>
                        <a href="#saveVisit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>saveVisit(searchedEvent: <a href="../classes/Event.html" target="_self">Event</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="373"
                            class="link-to-prism">src/events/events.service.ts:373</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>searchedEvent</td>
                                    <td>
                                                <code><a href="../classes/Event.html" target="_self" >Event</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="update"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>update</b></span>
                        <a href="#update"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>update(user: <a href="../classes/User.html" target="_self">User</a>, eventId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, updateEventInput: <a href="../classes/UpdateEventInput.html" target="_self">UpdateEventInput</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="304"
                            class="link-to-prism">src/events/events.service.ts:304</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>user</td>
                                    <td>
                                                <code><a href="../classes/User.html" target="_self" >User</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>eventId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>updateEventInput</td>
                                    <td>
                                                <code><a href="../classes/UpdateEventInput.html" target="_self" >UpdateEventInput</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updateAddress"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>updateAddress</b></span>
                        <a href="#updateAddress"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>updateAddress(event: <a href="../classes/Event.html" target="_self">Event</a>, eventAddress: <a href="../classes/CreateEventAddressInput.html" target="_self">CreateEventAddressInput</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="354"
                            class="link-to-prism">src/events/events.service.ts:354</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>event</td>
                                    <td>
                                                <code><a href="../classes/Event.html" target="_self" >Event</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>eventAddress</td>
                                    <td>
                                                <code><a href="../classes/CreateEventAddressInput.html" target="_self" >CreateEventAddressInput</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>unknown</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updateRate"></a>
                    <span class="name">
                        <span class="modifier">Async</span>
                        <span ><b>updateRate</b></span>
                        <a href="#updateRate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>updateRate(eventId: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, rate: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="362"
                            class="link-to-prism">src/events/events.service.ts:362</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>eventId</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>rate</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { eventType } from &#x27;src/events/entities/event.entity&#x27;;
import { EventAddress } from &#x27;./entities/event-address.entity&#x27;;
import { Participant } from &#x27;./../participants/entities/participant.entity&#x27;;
import {
  BadRequestException,
  forwardRef,
  Inject,
  Injectable,
} from &#x27;@nestjs/common&#x27;;
import { CreateEventInput } from &#x27;./dto/create-event.input&#x27;;
import { UpdateEventInput } from &#x27;./dto/update-event.input&#x27;;
import { InjectRepository } from &#x27;@nestjs/typeorm&#x27;;
import { Event } from &#x27;./entities/event.entity&#x27;;
import { Repository } from &#x27;typeorm&#x27;;
import { User } from &#x27;src/users/entities/user.entity&#x27;;
import { IEventState } from &#x27;./IEvents&#x27;;
import { CreateEventAddressInput } from &#x27;./dto/create-event-address.input&#x27;;
import { UserActivityService } from &#x27;src/user-activity/user-activity.service&#x27;;
import { UsersService } from &#x27;src/users/users.service&#x27;;
import { I18nService } from &#x27;nestjs-i18n&#x27;;
import { NotificationsService } from &#x27;src/notifications/notifications.service&#x27;;
import { Rating } from &#x27;src/ratings/entities/rating.entity&#x27;;

@Injectable()
export class EventsService {
  constructor(
    @InjectRepository(Event)
    private readonly eventsRepository: Repository&lt;Event&gt;,
    @InjectRepository(EventAddress)
    private readonly eventAddressRepository: Repository&lt;EventAddress&gt;,
    private readonly userActivityService: UserActivityService,
    private readonly userService: UsersService,
    private readonly i18n: I18nService,
    @Inject(forwardRef(() &#x3D;&gt; NotificationsService))
    private readonly notificationsService: NotificationsService,
  ) {}

  async create(createEventInput: CreateEventInput, user: User) {
    const event &#x3D; await this.eventsRepository.save({
      ...createEventInput,
      user,
    });

    const address &#x3D; await this.saveAddress(
      event,
      createEventInput.eventAddress,
    );
    event.eventAddress &#x3D; address;

    this.notificationsService.addNewJob(event);
    return event;
  }

  async findForEdit(eventId: string, userId: string) {
    const event &#x3D; await this.findOne(eventId);

    const user &#x3D; await this.userService.findOne(userId);

    if (event.user.id !&#x3D; user.id) {
      throw new BadRequestException(
        await this.i18n.translate(&#x27;errors.ERROR.USER_IS_NOT_OWNER_OF_EVENT&#x27;),
      );
    }

    return await event;
  }

  async find(eventId: string, userId: string) {
    const event &#x3D; this.eventsRepository
      .createQueryBuilder(&#x27;events&#x27;)
      .innerJoinAndMapOne(
        &#x27;events.user&#x27;,
        User,
        &#x27;users&#x27;,
        &#x27;events.user &#x3D; users.id&#x27;,
      )
      .loadRelationCountAndMap(
        &#x27;events.interestedCount&#x27;,
        &#x27;events.participants&#x27;,
        &#x27;p&#x27;,
        (qb) &#x3D;&gt; qb.andWhere(&#x27;p.type &#x3D; 1&#x27;),
      )
      .loadRelationCountAndMap(
        &#x27;events.goingCount&#x27;,
        &#x27;events.participants&#x27;,
        &#x27;p&#x27;,
        (qb) &#x3D;&gt; qb.andWhere(&#x27;p.type &#x3D; 2&#x27;),
      )
      .leftJoinAndMapOne(
        &#x27;events.eventAddress&#x27;,
        EventAddress,
        &#x27;event_address&#x27;,
        &#x27;events.id &#x3D; event_address.event&#x27;,
      );
    let user;
    if (userId) {
      user &#x3D; await this.userService.findOne(userId);
      event
        .leftJoinAndMapOne(
          &#x27;events.loggedInParticipants&#x27;,
          Participant,
          &#x27;loggedInParticipants&#x27;,
          &#x60;events.id &#x3D; loggedInParticipants.event and loggedInParticipants.user &#x3D; &quot;${user.id}&quot;&#x60;,
        )
        .leftJoinAndMapOne(
          &#x27;loggedInParticipants.user&#x27;,
          User,
          &#x27;u2&#x27;,
          &#x27;loggedInParticipants.user &#x3D; u2.id&#x27;,
        )
        .leftJoinAndMapOne(
          &#x27;events.participantRate&#x27;,
          Rating,
          &#x27;participantRate&#x27;,
          &#x60;events.id &#x3D; participantRate.event and participantRate.user &#x3D; &quot;${user.id}&quot;&#x60;,
        )
        .leftJoinAndMapOne(
          &#x27;participantRate.user&#x27;,
          User,
          &#x27;u3&#x27;,
          &#x27;participantRate.user &#x3D; u3.id&#x27;,
        );
    }

    event.andWhere(&#x60;events.id &#x3D; &#x27;${eventId}&#x27;&#x60;);
    const searchedEvent &#x3D; await event.getOne();

    if (userId) {
      this.userActivityService.saveEventView(user, searchedEvent);
    }
    this.saveVisit(searchedEvent);

    return searchedEvent;
  }

  findOne(eventId: string) {
    return this.eventsRepository.findOne({
      relations: [&#x27;user&#x27;],
      where: { id: eventId },
    });
  }

  async findAll(
    limit: number,
    offset: number,
    field: string,
    sort: string,
    query: string,
    state: IEventState,
    userId: string,
    distance: number,
    latitude: number,
    longitude: number,
    loggedUser: string,
    type: eventType,
    clientDate?: number,
  ) {
    const date &#x3D; clientDate ? new Date(clientDate * 1000) : new Date();
    const clientDateFormatted &#x3D; date.toISOString().replace(&#x27;T&#x27;, &#x27; &#x27;);

    const events &#x3D; this.eventsRepository
      .createQueryBuilder(&#x27;events&#x27;)
      .innerJoinAndMapOne(
        &#x27;events.user&#x27;,
        User,
        &#x27;users&#x27;,
        &#x27;events.user &#x3D; users.id&#x27;,
      )
      .leftJoinAndMapMany(
        &#x27;events.participants&#x27;,
        Participant,
        &#x27;participants&#x27;,
        &#x27;events.id &#x3D; participants.event&#x27;,
        { limit: &#x27;2&#x27; },
      )
      .leftJoinAndMapOne(
        &#x27;events.eventAddress&#x27;,
        EventAddress,
        &#x27;event_address&#x27;,
        &#x27;events.id &#x3D; event_address.event&#x27;,
      )
      .leftJoinAndMapOne(
        &#x27;participants.user&#x27;,
        User,
        &#x27;u&#x27;,
        &#x27;participants.user &#x3D; u.id&#x27;,
      )
      .loadRelationCountAndMap(
        &#x27;events.interestedCount&#x27;,
        &#x27;events.participants&#x27;,
        &#x27;p&#x27;,
        (qb) &#x3D;&gt; qb.andWhere(&#x27;p.type &#x3D; 1&#x27;),
      )
      .loadRelationCountAndMap(
        &#x27;events.goingCount&#x27;,
        &#x27;events.participants&#x27;,
        &#x27;p&#x27;,
        (qb) &#x3D;&gt; qb.andWhere(&#x27;p.type &#x3D; 2&#x27;),
      )
      .where(
        &#x27;(events.title like  :title or events.description like :description)&#x27;,
        { title: &#x60;%${query}%&#x60;, description: &#x60;%${query}%&#x60; },
      );
    if (loggedUser) {
      const user &#x3D; await this.userService.findOne(loggedUser);
      events
        .leftJoinAndMapOne(
          &#x27;events.loggedInParticipants&#x27;,
          Participant,
          &#x27;loggedInParticipants&#x27;,
          &#x60;events.id &#x3D; loggedInParticipants.event and loggedInParticipants.user &#x3D; &quot;${user.id}&quot;&#x60;,
        )
        .leftJoinAndMapOne(
          &#x27;loggedInParticipants.user&#x27;,
          User,
          &#x27;u2&#x27;,
          &#x27;loggedInParticipants.user &#x3D; u2.id&#x27;,
        );
    }
    let distanceQuery &#x3D; &#x27;0&#x27;;
    if (distance &amp;&amp; latitude &amp;&amp; longitude) {
      events.addSelect(
        &#x60;ROUND( 6371 * acos( cos( radians(${latitude}) ) * cos( radians( events.lat ) ) * cos( radians( events.lng ) - radians(${longitude}) ) + sin( radians(${latitude}) )* sin( radians( events.lat ) ) ) ,2)&#x60;,
        &#x27;events_distance&#x27;,
      );

      events.andWhere(
        &#x60;ROUND( 6371 * acos( cos( radians(${latitude}) ) * cos( radians( events.lat ) ) * cos( radians( events.lng ) - radians(${longitude}) ) + sin( radians(${latitude}) )* sin( radians( events.lat ) ) ) ,2) &lt;&#x3D; :userDistanceLimit&#x60;,
        { userDistanceLimit: distance },
      );

      distanceQuery &#x3D; &#x60;ROUND( 6371 * acos( cos( radians(${latitude}) ) * cos( radians( events.lat ) ) * cos( radians( events.lng ) - radians(${longitude}) ) + sin( radians(${latitude}) )* sin( radians( events.lat ) ) ) ,2) &lt;&#x3D; ${distance}&#x60;;
      if (userId) {
        this.userActivityService.saveDistanceSerchedQuery(userId, distance);
      }
    }
    if (loggedUser) {
      const user &#x3D; await this.userService.findOne(loggedUser);
      const activity &#x3D; await this.userActivityService.generateQuery(
        user,
        distanceQuery,
      );

      events.addSelect(&#x60;${activity}&#x60;, &#x27;events_score&#x27;);
    }

    if (state &#x3D;&#x3D;&#x3D; &#x27;DURING&#x27;) {
      events
        .andWhere(&#x27;events.startDate &lt;&#x3D; :startDate&#x27;, {
          startDate: clientDateFormatted,
        })
        .andWhere(&#x27;events.endDate &gt;&#x3D; :endDate&#x27;, {
          endDate: clientDateFormatted,
        });
    }

    if (state &#x3D;&#x3D;&#x3D; &#x27;FUTURE&#x27;) {
      events.andWhere(&#x27;events.startDate &gt; :startDate&#x27;, {
        startDate: clientDateFormatted,
      });
    }

    if (state &#x3D;&#x3D;&#x3D; &#x27;PAST&#x27;) {
      events.andWhere(&#x27;events.endDate &lt; :endDate&#x27;, {
        endDate: clientDateFormatted,
      });
    }

    if (userId) {
      events.andWhere(&#x27;events.user &#x3D; :userId&#x27;, {
        userId,
      });
    }

    if (type &gt;&#x3D; 0) {
      events.andWhere(&#x27;events.type &#x3D; :type&#x27;, {
        type,
      });
    }

    const totalRecords &#x3D; await events.getMany();

    if (distance &amp;&amp; latitude &amp;&amp; longitude &amp;&amp; field &#x3D;&#x3D; &#x27;distance&#x27;) {
      events.orderBy(&#x60;events_distance&#x60;, &#x27;ASC&#x27; &#x3D;&#x3D; sort ? &#x27;ASC&#x27; : &#x27;DESC&#x27;);
    } else if (field &#x3D;&#x3D; &#x27;score&#x27;) {
      if (loggedUser) {
        events.orderBy(&#x60;events_score&#x60;, &#x27;ASC&#x27; &#x3D;&#x3D; sort ? &#x27;ASC&#x27; : &#x27;DESC&#x27;);
      } else {
        events.orderBy(&#x60;events.startDate&#x60;, &#x27;ASC&#x27;);
      }
    } else {
      events.orderBy(&#x60;events.${field}&#x60;, &#x27;ASC&#x27; &#x3D;&#x3D; sort ? &#x27;ASC&#x27; : &#x27;DESC&#x27;);
    }

    const eventsMapped &#x3D; await events.take(limit).skip(offset).getMany();

    eventsMapped.map((event) &#x3D;&gt; {
      event.state &#x3D; state;
    });

    return { events: eventsMapped, totalRecords };
  }

  async update(
    user: User,
    eventId: string,
    updateEventInput: UpdateEventInput,
  ) {
    const event &#x3D; await this.findOne(eventId);
    const loggedUser &#x3D; await this.userService.findOne(user.id);

    if (event.user.id !&#x3D; loggedUser.id) {
      throw new BadRequestException(
        await this.i18n.translate(&#x27;errors.ERROR.USER_IS_NOT_OWNER_OF_EVENT&#x27;),
      );
    }

    this.notificationsService.deleteAllEventJobs(event);

    const updatedEvent &#x3D; await this.eventsRepository.save({
      ...event,
      ...updateEventInput,
    });

    const address &#x3D; await this.updateAddress(
      event,
      updateEventInput.eventAddress,
    );

    updatedEvent.eventAddress &#x3D; address;

    this.notificationsService.addNewJob(updatedEvent);
    return updatedEvent;
  }

  async remove(eventId: string) {
    try {
      const event &#x3D; await this.findOne(eventId);
      await this.eventsRepository.remove(event);

      return event;
    } catch (error) {
      console.error(error);
    }
  }

  async saveAddress(event: Event, eventAddress: CreateEventAddressInput) {
    return await this.eventAddressRepository.save({
      ...eventAddress,
      event,
    });
  }

  async updateAddress(event: Event, eventAddress: CreateEventAddressInput) {
    const address &#x3D; await this.eventAddressRepository.findOne({
      where: { event: event.id },
    });

    return this.eventAddressRepository.save({ ...address, ...eventAddress });
  }

  async updateRate(eventId: any, rate: number) {
    const event &#x3D; await this.findOne(eventId.id);
    const updateEvent &#x3D; event;
    updateEvent.rate &#x3D; rate;

    await this.eventsRepository.save({
      ...event,
      ...updateEvent,
    });
  }

  saveVisit(searchedEvent: Event) {
    this.eventsRepository
      .createQueryBuilder()
      .update(Event)
      .set({
        visitCount: () &#x3D;&gt; &#x27;visitCount + 1&#x27;,
      })
      .where(&#x27;id &#x3D; :id&#x27;, { id: searchedEvent.id })
      .execute();
  }

  async findAllForCalendar(
    limit: number,
    offset: number,
    field: string,
    sort: string,
    query: string,
    userId: string,
    type: eventType,
    startDate: Date,
    endDate: Date,
  ) {
    const startDateFormated &#x3D; startDate.toISOString().replace(&#x27;T&#x27;, &#x27; &#x27;);
    endDate.setHours(23, 59, 59, 999);
    const endDateFormated &#x3D; endDate.toISOString().replace(&#x27;T&#x27;, &#x27; &#x27;);

    const events &#x3D; this.eventsRepository
      .createQueryBuilder(&#x27;events&#x27;)
      .innerJoinAndMapOne(
        &#x27;events.user&#x27;,
        User,
        &#x27;users&#x27;,
        &#x27;events.user &#x3D; users.id&#x27;,
      )
      .leftJoinAndMapOne(
        &#x27;events.eventAddress&#x27;,
        EventAddress,
        &#x27;event_address&#x27;,
        &#x27;events.id &#x3D; event_address.event&#x27;,
      )
      .leftJoinAndMapOne(
        &#x27;events.loggedInParticipants&#x27;,
        Participant,
        &#x27;loggedInParticipants&#x27;,
        &#x60;events.id &#x3D; loggedInParticipants.event and loggedInParticipants.user &#x3D; &quot;${userId}&quot;&#x60;,
      )
      .leftJoinAndMapOne(
        &#x27;loggedInParticipants.user&#x27;,
        User,
        &#x27;u2&#x27;,
        &#x27;loggedInParticipants.user &#x3D; u2.id&#x27;,
      )
      .where(
        &#x27;(events.title like  :title or events.description like :description)&#x27;,
        { title: &#x60;%${query}%&#x60;, description: &#x60;%${query}%&#x60; },
      )
      .where(
        &#x60;( events.startDate &gt; :startDate and events.startDate &lt; :endDate or 
        events.endDate &lt; :startDate and events.endDate &gt; :endDate or
        events.startDate &lt; :startDate and events.endDate &gt; :startDate ) and ( events.user &#x3D; :userId or loggedInParticipants.user &#x3D; :userId)&#x60;,
        {
          startDate: &#x60;${startDateFormated}&#x60;,
          endDate: &#x60;${endDateFormated}&#x60;,
          userId: &#x60;${userId}&#x60;,
        },
      );

    if (type &#x3D;&#x3D;&#x3D; 0 || type &#x3D;&#x3D;&#x3D; 1 || type &#x3D;&#x3D;&#x3D; 2) {
      events.andWhere(&#x27;( events.type &#x3D; :type )&#x27;, { type: &#x60;${type}&#x60; });
    }
    const totalRecords &#x3D; await events.getMany();

    events.orderBy(&#x60;events.${field}&#x60;, &#x27;ASC&#x27; &#x3D;&#x3D; sort ? &#x27;ASC&#x27; : &#x27;DESC&#x27;);

    const eventsMapped &#x3D; await events.take(limit).skip(offset).getMany();

    return { events: eventsMapped, totalRecords };
  }
}
</code></pre>
    </div>

</div>












                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'EventsService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
